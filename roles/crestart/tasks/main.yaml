---
  - name: Obtener lista de contenedores
    containers.podman.podman_container_info:
      executable: podman
      containers: all
    register: podman_containers

  - name: Depurar variable podman_containers
    debug:
      var: podman_containers    

  - name: Mostrar lista de contenedores
    debug:
      msg:
        - "Nombre: {{ item.Name }}"
        - "Estado: {{ item.State.Status }}"
    loop: "{{ podman_containers.containers }}"
    loop_control:
      label: "{{ item.Name }}"


  - name: Reiniciar contenedores que no est√©n en estado running
    containers.podman.podman_container:
      name: "{{ item.Name }}"
      state: started
    with_items: "{{ podman_containers.containers }}"
    when: item.State.Running is not defined or not item.State.Running
    loop_control:
      label: "{{ item.Name }}"